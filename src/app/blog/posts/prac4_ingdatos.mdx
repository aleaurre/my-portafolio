---
title: "Decodificando la Ciudad: Joins a Gran Escala para un An√°lisis Exploratorio de Yellow Taxis y Zonas de NYC."
publishedAt: "2025-09-14"
tag: "Curso: Ingenier√≠a de Datos"
image: "/practica4/portada.jpg"
---

import { Heading, Text, InlineCode, Row, Line, CodeBlock } from "@once-ui-system/core";
import { SmartLink } from "@once-ui-system/core";


# EDA Multifuentes y Joins en Gran Escala

**NYC Yellow Taxi + Taxi Zones + Calendar (2023-01)**
*(Versi√≥n ampliada y contextualizada ‚Äî +2500 palabras aprox.)*

## 1. Introducci√≥n y Problema Anal√≠tico

La ciudad de Nueva York constituye uno de los sistemas de **movilidad urbana m√°s complejos del mundo**, combinando infraestructura 
densa, diversidad socioespacial y un volumen de desplazamientos sin pausa. Dentro de ese ecosistema, el **servicio de Yellow Taxi**
 mantiene un rol hist√≥rico como **indicador de la vitalidad econ√≥mica** y de las **relaciones centro-periferia** en la ciudad.
El objetivo del presente estudio es desarrollar un **An√°lisis Exploratorio de Datos multifuente**, integrando tres fuentes con 
estructuras, formatos y granularidad diferenciadas:

<table>
  <thead>
    <tr>
      <th>Fuente</th>
      <th>Formato</th>
      <th>Naturaleza</th>
      <th>Cardinalidad</th>
      <th>Rol en el an√°lisis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Yellow Trip Data 2023-01</td>
      <td>Parquet</td>
      <td>Registros transaccionales</td>
      <td>3,066,766 viajes</td>
      <td>N√∫cleo del an√°lisis (movilidad real)</td>
    </tr>
    <tr>
      <td>Taxi Zone Lookup</td>
      <td>CSV</td>
      <td>Base geoespacial categ√≥rica</td>
      <td>265 zonas</td>
      <td>Mapeo &rarr; Borough</td>
    </tr>
    <tr>
      <td>NYC Events Calendar</td>
      <td>JSON</td>
      <td>Eventos extraordinarios</td>
      <td>31 d√≠as</td>
      <td>Se√±al ex√≥gena</td>
    </tr>
  </tbody>
</table>


Esta integraci√≥n permite responder preguntas que **una sola fuente no podr√≠a contestar**, entre ellas:

- ¬øC√≥mo se distribuye la movilidad **espacialmente** en la ciudad?
- ¬øQu√© patrones **temporales** estructuran la demanda?
- ¬øExisten factores **externos** (eventos) que impactan los viajes?
- ¬øCu√°les son los **puntos cr√≠ticos operativos** del sistema?
- ¬øCu√°l es la **calidad y completitud** real de los datos oficiales?

M√°s all√° de describir la movilidad, el enfoque metodol√≥gico persigue **producir evidencia para decisiones p√∫blicas**: tarifas, disponibilidades, rutas preferenciales, planificaci√≥n de transporte multimodal y gesti√≥n del tr√°nsito en zonas cr√≠ticas.

---

## 2. Marco Te√≥rico y Conceptos Relevantes

### 2.1 Movilidad Urbana Basada en Datos

Los registros de taxi capturan se√±ales indirectas sobre:

- **actividad econ√≥mica** (picos en centros comerciales/financieros)
- **turismo** (conexiones con aeropuertos y hoteles)
- **variaciones horarias en la fuerza laboral**
- **desigualdades territoriales** en accesibilidad

En estudios previos, la movilidad act√∫a como **proxy robusto del pulso urbano**.

### 2.2 Integraci√≥n heterog√©nea de datos

Este caso materializa un pipeline ETL acad√©mico, pero con **condiciones reales de producci√≥n**:
formatos distintos ‚Üí necesidades de tipificaci√≥n ‚Üí normalizaci√≥n sem√°ntica ‚Üí reselecci√≥n de claves ‚Üí 
control de integridad referencial

En ingenier√≠a de datos, esto se liga directamente al **lineaje de datos**, la **detecci√≥n temprana de anomal√≠as**,
y la **mantenibilidad y versionado**. Trabajo idealmente **orquestable** con Prefect o Airflow ‚Üí ver secci√≥n 8.

### 2.3 Joins geogr√°ficos

La uni√≥n entre viajes y zonas no solo agrega una columna ‚Äî habilita una **interpretaci√≥n territorial**, donde la movilidad se piensa por **borough**:

<table>
  <thead>
    <tr>
      <th>Borough</th>
      <th>Caracter√≠stica socioespacial dominante</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Manhattan</td>
      <td>Hiperconcentraci√≥n de actividad econ√≥mica</td>
    </tr>
    <tr>
      <td>Queens</td>
      <td>Transporte interborough y aeropuertos</td>
    </tr>
    <tr>
      <td>Brooklyn</td>
      <td>Residencia y ocio en crecimiento</td>
    </tr>
    <tr>
      <td>Bronx</td>
      <td>Viajes m√°s largos hacia Manhattan</td>
    </tr>
    <tr>
      <td>Staten Island</td>
      <td>Baja densidad, uso marginal del taxi</td>
    </tr>
  </tbody>
</table>


Con ello, los viajes dejan de ser ‚Äúpuntos aislados‚Äù y se convierten en **trayectorias urbanas significativas**.

---

## 3. Dise√±o Metodol√≥gico

1. **Lectura e inspecci√≥n** de cada fuente
2. **Normalizaci√≥n estructural**: `snake_case`, categoricidad, tipificaci√≥n
3. Derivaci√≥n de **tiempo interpretable**: `pickup_date`, hora y d√≠a de la semana
4. **Join espacial**: `pulocationid ‚ü∂ locationid`
5. **Join temporal**: `pickup_date ‚ü∂ date` en calendario
6. Auditor√≠a de **match rate** y **zone coverage**
7. **KPIs y agregados multi-nivel**: por borough, por hora
8. Estrategias de **performance** para millones de registros
9. S√≠ntesis anal√≠tica y reflexiones

Todo el pipeline fue dise√±ado de forma **determin√≠stica y reproducible**.

---

## 4. Calidad y validaci√≥n de la integraci√≥n

La primera validaci√≥n clave fue medir la proporci√≥n de viajes correctamente mapeados:

<table>
  <thead>
    <tr>
      <th>M√©trica</th>
      <th>Valor</th>
      <th>Interpretaci√≥n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Viajes totales</td>
      <td>3,066,766</td>
      <td>Universo de an√°lisis</td>
    </tr>
    <tr>
      <td>Coincidencias con zonas</td>
      <td>3,055,808</td>
      <td>Join exitoso</td>
    </tr>
    <tr>
      <td><strong>Match rate</strong></td>
      <td><strong>99.6%</strong></td>
      <td>Excelente integridad de claves</td>
    </tr>
    <tr>
      <td>Zonas utilizadas</td>
      <td>259 / 265</td>
      <td><strong>97.7%</strong> cobertura espacial</td>
    </tr>
    <tr>
      <td>Eventos en calendario</td>
      <td>Enero sin eventos registrados</td>
      <td>Mes baseline sin estacionalidad festiva</td>
    </tr>
  </tbody>
</table>


Esto evidencia que **los datos son confiables**, algo nada menor en transporte urbano.

Las 6 zonas nunca utilizadas corresponden a regiones lim√≠trofes o administrativas ‚Üí se√±al de **actividad concentrada**, 
no de error de datos. En cuanto al calendario:
- enero de 2023 no contiene eventos registrados
- el mes funciona como **baseline sin estacionalidad festiva**
Esto resultar√° clave en an√°lisis futuros ‚Üí comparaci√≥n contra meses con feriados (Ej: Thanksgiving, A√±o Nuevo).

---

## 5. Resultados Descriptivos y Se√±ales Urbanas

### 5.1 Volumen urbano

La magnitud del sistema es contundente:

- m√°s de 3 millones de viajes en 31 d√≠as
- aproximadamente 100.000 viajes diarios
- al rededor de 4.000 viajes por hora en picos

El taxi contin√∫a siendo una **infraestructura estrat√©gica** dentro de NYC.

---

### 5.2 Distancia y tarifas

<table>
  <thead>
    <tr>
      <th>M√©trica global</th>
      <th>Valor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Distancia media</td>
      <td>3.85 millas</td>
    </tr>
    <tr>
      <td>Tarifa promedio</td>
      <td>USD 27.02</td>
    </tr>
  </tbody>
</table>

Esto refleja la estructura tarifaria basada en tarifa base, distancia, peajes y recargos metropolitano-tur√≠sticos
Diferencias por borough:
- *Manhattan* ‚Üí viajes cortos y frecuentes
- *Queens* ‚Üí viajes largos y caros, conectando aeropuertos

---

### 5.3 Dominio geogr√°fico del borough

Distribuci√≥n por origen del viaje:

<table>
  <thead>
    <tr>
      <th>Borough</th>
      <th>Viajes</th>
      <th>Participaci√≥n</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Manhattan</strong></td>
      <td>2,715,369</td>
      <td><strong>88.6%</strong></td>
    </tr>
    <tr>
      <td>Queens</td>
      <td>286,645</td>
      <td>9.3%</td>
    </tr>
    <tr>
      <td>Unknown</td>
      <td>40,116</td>
      <td>1.3%</td>
    </tr>
    <tr>
      <td>Bronx, Brooklyn, Staten Island</td>
      <td>Valores marginales</td>
      <td>&lt; 1%</td>
    </tr>
  </tbody>
</table>


Conclusi√≥n: el taxi amarillo es principalmente un **servicio manhattan-c√©ntrico**
Un patr√≥n asociado a destinos tur√≠sticos, centralidad laboral e infraestructura de calles y disponibilidad de taxis.
Este sesgo territorial debe ser considerado en pol√≠ticas de accesibilidad urbana.

---

### 5.4 Din√°mica del tiempo: la ciudad que nunca duerme

Se observaron **picos horarios claros** de **18:00 ‚Üí 17:00 ‚Üí 15:00**

La curva difiere del transporte tradicional:

<table>
  <thead>
    <tr>
      <th>Hora cr√≠tica</th>
      <th>Causa estructural</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>15:00</td>
      <td>Turismo y ocio temprano (check-in, paseos, compras)</td>
    </tr>
    <tr>
      <td>17:00</td>
      <td>Commuting laboral (salidas de oficinas y trasbordos intermodales)</td>
    </tr>
    <tr>
      <td>18:00</td>
      <td>Cenas, espect√°culos y transici√≥n hacia ocio nocturno</td>
    </tr>
  </tbody>
</table>


El patr√≥n confirma que **la movilidad nocturna es motor del sistema econ√≥mico de Manhattan**.

---

## 6. Perspectiva de negocios y pol√≠tica p√∫blica

Cada hallazgo puede traducirse en una **acci√≥n**:

<table>
  <thead>
    <tr>
      <th>Hallazgo</th>
      <th>Decisi√≥n habilitada</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Picos horarios entre 15 y 18 h</td>
      <td>Definir refuerzo de flota y potenciales tarifas din√°micas en ese rango</td>
    </tr>
    <tr>
      <td>Queens concentra viajes m√°s largos y costosos</td>
      <td>Evaluar pol√≠ticas de accesibilidad y alternativas de transporte complementario</td>
    </tr>
    <tr>
      <td>Cobertura espacial del 97.7%</td>
      <td>Usar estos datos como base para m√©tricas oficiales de movilidad urbana</td>
    </tr>
    <tr>
      <td>1.3% de viajes con borough desconocido</td>
      <td>Mejorar captura de ubicaci√≥n (GPS / sistemas de reporte) y auditor√≠as</td>
    </tr>
  </tbody>
</table>


Vincular datos a decisiones p√∫blicas **cierra el ciclo anal√≠tico**.

---

## 7. Performance y escalabilidad

Dado el tama√±o del dataset, se aplicaron optimizaciones: **Downcast** en columnas enteras (IDs), 
**Muestreo estratificado** del 0.3% para gr√°ficos y Eficiencia Parquet: columnas comprimidas y lectura paralela.
Esto reduce costos computacionales y prepara la base para escalar de 1 mes ‚Üí **12 meses ‚Üí >40 millones de viajes/a√±o**

El aprendizaje t√©cnico aqu√≠ es tan importante como la anal√≠tica en s√≠.

---

## 8. Arquitectura para automatizaci√≥n (Prefect / DataOps)

Esta pr√°ctica desemboca naturalmente en un **pipeline orquestado**.

¬øPor qu√© usar `@task`?

* permite **reintentos autom√°ticos**
* captura **logs y m√©tricas**
* habilita **observabilidad en tiempo real**
* aisla errores en pasos espec√≠ficos

¬øQu√© aporta `@flow`?

Administra el **flujo l√≥gico completo**, asegurando ejecuci√≥n en orden y permitiendo correr tareas **en paralelo** cuando no tienen dependencia directa.

Casos aplicados al dataset: carga incremental mensual, refresco de dashboards, modelos para pron√≥stico de demanda horaria y
monitoreo operativo en Smart City. Por lo tanto, la pr√°ctica no solo ense√±a EDA ‚Äî introduce **pensamiento de producci√≥n**.

---

## 9. S√≠ntesis Ejecutiva (Insights de alto valor)

<table>
  <thead>
    <tr>
      <th>Dimensi√≥n</th>
      <th>Observaci√≥n t√©cnica</th>
      <th>Implicancia estrat√©gica</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Mix de contenido (viajes)</td>
      <td>Alt√≠sima densidad en Manhattan</td>
      <td>Priorizar regulaci√≥n de tr√°nsito en el core urbano</td>
    </tr>
    <tr>
      <td>Accesibilidad territorial</td>
      <td>Queens presenta viajes m√°s largos y con mayor importe medio</td>
      <td>Riesgo de desigualdad en transporte; analizar conectividad y tarifas</td>
    </tr>
    <tr>
      <td>Ritmo urbano</td>
      <td>Picos de demanda entre las 15:00 y las 18:00</td>
      <td>Optimizar asignaci√≥n de flota y pol√≠ticas de pricing en esa franja</td>
    </tr>
    <tr>
      <td>Calidad de datos</td>
      <td>Match rate 99.6% y cobertura espacial 97.7%</td>
      <td>Base robusta para modelos de predicci√≥n y monitoreo en tiempo real</td>
    </tr>
    <tr>
      <td>Estacionalidad de eventos</td>
      <td>Enero funciona como mes baseline sin festividades mayores</td>
      <td>√ötil como referencia para comparar con meses de alta estacionalidad</td>
    </tr>
  </tbody>
</table>


---

## 10. Limitaciones del estudio

- No se analiza origen-destino completo (solo pickup location)
- Ausencia de se√±al meteorol√≥gica
- Eventos culturales no incluidos pueden existir fuera de API oficial
- Falta la visi√≥n multimodal (metro, buses, ridesharing)
Estas limitaciones gu√≠an el roadmap evolutivo.

---

## 11. L√≠neas de trabajo futuro

<table>
  <thead>
    <tr>
      <th>Propuesta</th>
      <th>Impacto esperado</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Incorporar variables meteorol√≥gicas</td>
      <td>Cuantificar el efecto de lluvia, nieve y extremo fr√≠o sobre la demanda</td>
    </tr>
    <tr>
      <td>Analizar origen-destino completo</td>
      <td>Modelar flujos urbanos en red y detectar corredores estructurales</td>
    </tr>
    <tr>
      <td>Comparar meses festivos vs. baseline</td>
      <td>Medir impacto tur√≠stico y de feriados en la movilidad</td>
    </tr>
    <tr>
      <td>Construir modelos de forecasting horario</td>
      <td>Planificar capacidad de flota y gestionar congesti√≥n por anticipado</td>
    </tr>
    <tr>
      <td>Desarrollar visualizaci√≥n geoespacial avanzada</td>
      <td>Monitorear en mapas de calor la distribuci√≥n din√°mica de viajes</td>
    </tr>
  </tbody>
</table>


---

## 12. Conclusi√≥n General

El estudio demuestra que el an√°lisis multifuente y los joins **no son una etapa secundaria**, sino la condici√≥n habilitante para transformar datos fragmentados en **conocimiento urbano estructural**.

Los resultados cuantitativos validan el buen estado de los registros, mientras que los an√°lisis espaciales y horarios evidencian patrones coherentes con los usos reales de la ciudad. El sistema de taxis se confirma como:
**term√≥metro econ√≥mico**, **sensor distribuido de movilidad** e **indicador de desigualdad territorial**.

Finalmente, el enfoque metodol√≥gico utilizado prepara la base para **automatizar y escalar** todo el pipeline a largo plazo, alineado con principios modernos de ingenier√≠a de datos (**CI/CD**, **DataOps**, **observabilidad**, **trazabilidad**).

Este trabajo, aunque exploratorio, se posiciona a medio camino entre **anal√≠tica urbana** y **sistemas productivos de transporte inteligente**, demostrando c√≥mo la ingenier√≠a de datos se integra con la planificaci√≥n urbana basada en evidencia.

---
## Evidencias

Para consultar el c√≥digo √≠ntegro, las funciones aplicadas, la generaci√≥n de gr√°ficos y los resultados intermedios de la pr√°ctica, se adjunta el notebook original:

üìé **Google Colab:** [Abrir notebook](https://colab.research.google.com/drive/1nmvyicDC-SEgmSqm1VbCXRgc2bKuUeT9?usp=sharing)

---